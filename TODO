* rewrite all of this shit in pure c for speed
